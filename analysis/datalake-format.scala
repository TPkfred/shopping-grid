// val data_dir = "/data/estreaming/datalake_1_5/20220901/*"
// entire day was huge. start with a single hour
val data_dir = "/data/estreaming/datalake_1_5/20220901/00/"
val df = spark.read.parquet(data_dir)
// count: 1715000000

df2 = spark.read.parquet("/data/estreaming/midt_1_5/20220901/00/")
// count: 1812500000

val df2 = df.withColumn("trip_duration", (col("out_arrival_epoc") - col("out_departure_epoc"))/60)

df2.select("trip_duration", 
    "out_trip_duration_time", 
 "out_departure_date",
 "out_departure_time",
 "out_departure_time_zone",
 "out_departure_epoc",
 "out_arrival_date",
 "out_arrival_time",
 "out_arrival_time_zone",
 "out_arrival_epoc"
    ).show()


|trip_duration|out_trip_duration_time|out_departure_date|out_departure_time|out_departure_time_zone|out_departure_epoc|out_arrival_date|out_arrival_time|out_arrival_time_zone|out_arrival_epoc|
+-------------+----------------------+------------------+------------------+-----------------------+------------------+----------------+----------------+---------------------+----------------+
|        440.0|                   880|          20220902|              1510|                    ICT|        1662106200|        20220902|            2230|                  ICT|      1662132600|
|         93.0|                   153|          20221123|              1500|                     CT|        1669237200|        20221123|            1633|                   CT|      1669242780|
|        181.0|                   482|          20220919|               824|                     MT|        1663601040|        20220919|            1125|                   PT|      1663611900|
|        757.0|                  1274|          20221013|              2338|                     CT|        1665722280|        20221014|            1215|                   CT|      1665767700|
|        401.0|                   922|          20220919|               824|                     MT|        1663601040|        20220919|            1505|                   PT|      1663625100|
|        325.0|                   650|          20220902|              1200|                    ICT|        1662094800|        20220902|            1725|                  ICT|      1662114300|
|       1220.0|                  2740|          20221201|               350|                     AT|        1669855800|        20221201|            1610|                   ET|      1669929000|
|        440.0|                  1000|          20220929|              1130|                    WIB|        1664425800|        20220929|            1850|                  WIB|      1664452200|
|       1050.0|                  2220|          20230317|              2105|                    ICT|        1679061900|        20230318|            1435|                  ICT|      1679124900|
|        440.0|                  1000|          20220929|              1130|                    WIB|        1664425800|        20220929|            1850|                  WIB|      1664452200|
|       1095.0|                  1830|          20221219|              1305|                    EET|        1671444300|        20221220|             720|                  EET|      1671510000|
|        252.0|                   504|          20221123|              1020|                     ET|        1669216800|        20221123|            1332|                   CT|      1669231920|
|       1530.0|                  3180|          20230317|              1305|                    ICT|        1679033100|        20230318|            1435|                  ICT|      1679124900|
|       1234.0|                  3882|          20230128|              1321|                     ET|        1674930060|        20230129|            1055|                   AT|      1675004100|
|        405.0|                   810|          20220902|              1005|                    ICT|        1662087900|        20220902|            1650|                  ICT|      1662112200|
|        545.0|                   850|          20221013|              1107|                     CT|        1665677220|        20221013|            2012|                   CT|      1665709920|
|        252.0|                   504|          20221123|              1020|                     ET|        1669216800|        20221123|            1332|                   CT|      1669231920|
|       1095.0|                  1830|          20221219|              1305|                    EET|        1671444300|        20221220|             720|                  EET|      1671510000|
|       1405.0|                  4395|          20230128|              1230|                    COT|        1674927000|        20230129|            1255|                   AT|      1675011300|
|        410.0|                   820|          20220902|              1055|                    ICT|        1662090900|        20220902|            1745|                  ICT|      1662115500|
+-------------+----------------------+------------------+------------------+-----------------------+------------------+----------------+----------------+---------------------+----------------+

df.select(
 col("out_departure_date"),
 col("out_departure_time"),
 col("out_departure_time_zone"),
 col("out_departure_epoc"),
 from_unixtime(col("out_departure_epoc"), "yyyy-MM-dd HH:mm").as("out_dept_epoc_dt"),
 col("in_departure_date"),
 col("in_departure_time"),
 col("in_departure_time_zone"),
 col("in_departure_epoc"),
 from_unixtime(col("in_departure_epoc"), "yyyy-MM-dd HH:mm").as("in_dept_epoc_dt")
).show()

+------------------+------------------+-----------------------+------------------+----------------+-----------------+-----------------+----------------------+-----------------+----------------+
|out_departure_date|out_departure_time|out_departure_time_zone|out_departure_epoc|out_dept_epoc_dt|in_departure_date|in_departure_time|in_departure_time_zone|in_departure_epoc| in_dept_epoc_dt|
+------------------+------------------+-----------------------+------------------+----------------+-----------------+-----------------+----------------------+-----------------+----------------+
|          20220902|              1510|                    ICT|        1662106200|2022-09-02 08:10|         20220904|             1800|                   ICT|       1662289200|2022-09-04 11:00|
|          20221123|              1500|                     CT|        1669237200|2022-11-23 21:00|         20221130|             1355|                    CT|       1669838100|2022-11-30 19:55|
|          20220919|               824|                     MT|        1663601040|2022-09-19 15:24|                0|                0|                      |                0|1970-01-01 00:00|
|          20221013|              2338|                     CT|        1665722280|2022-10-14 04:38|         20221016|              735|                    CT|       1665923700|2022-10-16 12:35|
|          20220919|               824|                     MT|        1663601040|2022-09-19 15:24|                0|                0|                      |                0|1970-01-01 00:00|
|          20220902|              1200|                    ICT|        1662094800|2022-09-02 05:00|         20220904|             1435|                   ICT|       1662276900|2022-09-04 07:35|
|          20221201|               350|                     AT|        1669855800|2022-12-01 00:50|         20221208|             2025|                    ET|       1670549100|2022-12-09 01:25|
|          20220929|              1130|                    WIB|        1664425800|2022-09-29 04:30|         20221004|             1840|                   WIB|       1664883600|2022-10-04 11:40|
|          20230317|              2105|                    ICT|        1679061900|2023-03-17 14:05|                0|                0|                      |                0|1970-01-01 00:00|
|          20220929|              1130|                    WIB|        1664425800|2022-09-29 04:30|         20221004|             1525|                   WIB|       1664871900|2022-10-04 08:25|
|          20221219|              1305|                    EET|        1671444300|2022-12-19 10:05|         20221223|             1935|                   EET|       1671813300|2022-12-23 16:35|
|          20221123|              1020|                     ET|        1669216800|2022-11-23 15:20|         20221130|             1040|                    CT|       1669826400|2022-11-30 16:40|
|          20230317|              1305|                    ICT|        1679033100|2023-03-17 06:05|         20230319|             2200|                   ICT|       1679238000|2023-03-19 15:00|
|          20230128|              1321|                     ET|        1674930060|2023-01-28 18:21|         20230204|             1212|                    AT|       1675527120|2023-02-04 16:12|
|          20220902|              1005|                    ICT|        1662087900|2022-09-02 03:05|         20220904|             1800|                   ICT|       1662289200|2022-09-04 11:00|
|          20221013|              1107|                     CT|        1665677220|2022-10-13 16:07|         20221016|              829|                    CT|       1665926940|2022-10-16 13:29|
|          20221123|              1020|                     ET|        1669216800|2022-11-23 15:20|         20221130|             1212|                    CT|       1669831920|2022-11-30 18:12|
|          20221219|              1305|                    EET|        1671444300|2022-12-19 10:05|         20221223|             1735|                   EET|       1671806100|2022-12-23 14:35|
|          20230128|              1230|                    COT|        1674927000|2023-01-28 17:30|         20230204|             1212|                    AT|       1675527120|2023-02-04 16:12|
|          20220902|              1055|                    ICT|        1662090900|2022-09-02 03:55|         20220904|             1825|                   ICT|       1662290700|2022-09-04 11:25|
+------------------+------------------+-----------------------+------------------+----------------+-----------------+-----------------+----------------------+-----------------+----------------+

val df_expl = df.withColumn("request_PTC_flat", explode("request_PTC")).withColumn("response_PTC_flat", explode("response_PTC"))
// count: 1991209582

val df_expl2 = df_expl.withColumn("request_PTC_flat_mod", regexp_extract(col("request_PTC_flat"), "(.*).$", 1))
df_expl2.filter($"request_PTC_flat_mod" !== $"response_PTC_flat").count()
// 527908819, ~25%!


df_expl2.filter($"request_PTC_flat_mod" !== $"response_PTC_flat").select("request_PTC", "request_PTC_flat", "request_PTC_flat_mod", "response_PTC", "response_PTC_flat").show()
warning: there was one deprecation warning; re-run with -deprecation for details
+-----------+----------------+--------------------+------------+-----------------+
|request_PTC|request_PTC_flat|request_PTC_flat_mod|response_PTC|response_PTC_flat|
+-----------+----------------+--------------------+------------+-----------------+
|     [ITX1]|            ITX1|                 ITX|       [ADT]|              ADT|
|     [JWZ2]|            JWZ2|                 JWZ|       [ADT]|              ADT|
|     [ITX1]|            ITX1|                 ITX|       [ADT]|              ADT|
|     [JWZ1]|            JWZ1|                 JWZ|       [ADT]|              ADT|
|     [JWZ2]|            JWZ2|                 JWZ|       [ADT]|              ADT|
|     [ITX1]|            ITX1|                 ITX|       [ADT]|              ADT|
|     [JWZ1]|            JWZ1|                 JWZ|       [ADT]|              ADT|
|     [ITX1]|            ITX1|                 ITX|       [ADT]|              ADT|
|     [JWZ1]|            JWZ1|                 JWZ|       [ADT]|              ADT|
|     [JWZ1]|            JWZ1|                 JWZ|       [ADT]|              ADT|
|     [ITX1]|            ITX1|                 ITX|       [ADT]|              ADT|
|     [JWZ2]|            JWZ2|                 JWZ|       [ADT]|              ADT|
|     [JWZ2]|            JWZ2|                 JWZ|       [ADT]|              ADT|
|     [JWZ1]|            JWZ1|                 JWZ|       [ADT]|              ADT|
|     [JWZ1]|            JWZ1|                 JWZ|       [ADT]|              ADT|
|     [JWZ2]|            JWZ2|                 JWZ|       [ADT]|              ADT|
|     [ITX1]|            ITX1|                 ITX|       [ADT]|              ADT|
|     [JWZ2]|            JWZ2|                 JWZ|       [ADT]|              ADT|
|     [JWZ2]|            JWZ2|                 JWZ|       [ADT]|              ADT|
|     [ITX1]|            ITX1|                 ITX|       [ADT]|              ADT|
+-----------+----------------+--------------------+------------+-----------------+

// ITX = 	Individual Inclusive Tour
// JWZ =  ITX/JCB/PFA/PFS/WEB Blended

// From eStreaming Transmission File Technical Specifications, the
// response PTC is the PTC used in the far calculation. So this is what we want.

// id vs. group_id, etc
df.select(countDistinct($"id")).show()
// > 11933126
// 11,933,126 out of 1,715,000,000


+----------------+--------+------------------+---+----+-------------+------------------+-------------------------+-----------+-----------------+----------------+--------+------------+--------+-------+-------+--------------+----------------------+---------------------+--------------------+--------------------+------------+----------+-------------------------+----------------------+-------------+----------------------+------------+------------------+-----------------------+---------------+--------------------+------------------+------------------+----------------+----------------+-----------------------+---------------------+------------------+----------------+----------------------+--------------------+------------------+-----------------+-----------------+------------------+-----------------+---------------+---------+----------------+--------------+------------+--------------------+--------------------+-----------+---------------+--------------------+---------------------------+-----------------------------+---------------------------+-------------------+-------------+-------------------------------------+-------------------+------------------+-------------------------------+------------------------------+----------------+-------------+---------------+---------------------+-----------+-----------------+----------------------+--------------+-------------------+-----------------+-----------------+---------------+---------------+----------------------+--------------------+-----------------+---------------+---------------------+-------------------+-----------------+----------------+----------------+------------------+----------------+--------------+--------+---------------+---------------+-----------+--------------------+--------------------+---------------+--------------+-------------------+--------------------------+----------------------------+--------------------------+------------------+------------+------------------------------------+------------------+--------------------+------------------------------+-----------------------------+---------------+------------+----------+
|              id|group_id|shop_req_timeStamp|gds| pcc|point_of_sale|constricted_search|lowest_fare_not_in_result|request_PTC|robotic_shop_type|confidence_level|pos_city|private_fare|currency|   fare|    tax|validating_cxr|fare_break_down_by_PTC|tax_break_down_by_PTC|       tax_breakdown|         refund_rule|response_PTC|channel_id|private_fare_account_code|fare_construction_text|out_durations|out_trip_duration_time|out_layovers|out_origin_airport|out_destination_airport|out_origin_city|out_destination_city|out_departure_date|out_departure_time|out_arrival_date|out_arrival_time|out_departure_time_zone|out_arrival_time_zone|out_departure_epoc|out_arrival_epoc|out_departure_terminal|out_arrival_terminal|out_airport_search|out_marketing_cxr|out_operating_cxr|out_flight_numbers|out_booking_class|out_cabin_class|out_seats|out_avail_source|out_equipments|out_segments| out_fare_components|      out_fare_types|out_baggage|out_refund_rule|out_incidental_stops|out_incidental_stop_airport|out_incidental_stop_departure|out_incidental_stop_arrival|out_change_of_gauge|out_stop_over|out_availability_connection_indicator|out_remaining_seats|      out_brand_id|out_codeshare_operating_carrier|out_codeshare_operating_flight|out_via_airports|out_num_stops|   in_durations|in_trip_duration_time|in_layovers|in_origin_airport|in_destination_airport|in_origin_city|in_destination_city|in_departure_date|in_departure_time|in_arrival_date|in_arrival_time|in_departure_time_zone|in_arrival_time_zone|in_departure_epoc|in_arrival_epoc|in_departure_terminal|in_arrival_terminal|in_airport_search|in_marketing_cxr|in_operating_cxr| in_flight_numbers|in_booking_class|in_cabin_class|in_seats|in_avail_source|  in_equipments|in_segments|  in_fare_components|       in_fare_types|     in_baggage|in_refund_rule|in_incidental_stops|in_incidental_stop_airport|in_incidental_stop_departure|in_incidental_stop_arrival|in_change_of_gauge|in_stop_over|in_availability_connection_indicator|in_remaining_seats|         in_brand_id|in_codeshare_operating_carrier|in_codeshare_operating_flight|in_via_airports|in_num_stops|market_key|
+----------------+--------+------------------+---+----+-------------+------------------+-------------------------+-----------+-----------------+----------------+--------+------------+--------+-------+-------+--------------+----------------------+---------------------+--------------------+--------------------+------------+----------+-------------------------+----------------------+-------------+----------------------+------------+------------------+-----------------------+---------------+--------------------+------------------+------------------+----------------+----------------+-----------------------+---------------------+------------------+----------------+----------------------+--------------------+------------------+-----------------+-----------------+------------------+-----------------+---------------+---------+----------------+--------------+------------+--------------------+--------------------+-----------+---------------+--------------------+---------------------------+-----------------------------+---------------------------+-------------------+-------------+-------------------------------------+-------------------+------------------+-------------------------------+------------------------------+----------------+-------------+---------------+---------------------+-----------+-----------------+----------------------+--------------+-------------------+-----------------+-----------------+---------------+---------------+----------------------+--------------------+-----------------+---------------+---------------------+-------------------+-----------------+----------------+----------------+------------------+----------------+--------------+--------+---------------+---------------+-----------+--------------------+--------------------+---------------+--------------+-------------------+--------------------------+----------------------------+--------------------------+------------------+------------+------------------------------------+------------------+--------------------+------------------------------+-----------------------------+---------------+------------+----------+
|1742722298728281|     423|        1661989494| 1G|8M65|           IN|             false|                    false|     [ADT1]|                0|               0|     DEL|       false|     INR|82197.0|24572.0|            GP|             [82197.0]|            [24572.0]|[[AX,682.0], [C4,...|NonRef-Can-100P-A...|       [ADT]|         0|                       []|  SGN A1 HAN 191.00...|   [130, 110]|                   880|          []|               SGN|                    CXR|            SGN|                 NHA|          20220902|              1510|        20220902|            2230|                    ICT|                  ICT|        1662106200|      1662132600|                  null|                null|             false|         [A1, A1]|         [VJ, VJ]|      [2138, 2785]|           [V, V]|         [W, W]|      [1]|          [A, A]|    [321, 321]|          []|[WrappedArray(Wra...|[WrappedArray(WR,...| [30K, 30K]|           null|                 [0]|                        [0]|                          [0]|                        [0]|               [, ]|       [, , ]|                                 [, ]|         [004, 004]|[1094706, 1094706]|                       [VJ, VJ]|                  [0138, 0785]|           [HAN]|            1|      [95, 110]|                 1950|         []|              CXR|                   SGN|           NHA|                SGN|         20220904|             1800|       20220905|           1015|                   ICT|                 ICT|       1662289200|     1662347700|                 null|               null|            false|        [A1, A1]|        [VJ, VJ]|      [2794, 2213]|          [V, V]|        [W, W]|     [1]|         [A, A]|     [321, 321]|         []|[WrappedArray(Wra...|[WrappedArray(WR,...|     [30K, 30K]|          null|                [0]|                       [0]|                         [0]|                       [0]|              [, ]|      [, , ]|                                [, ]|        [004, 004]|  [1094706, 1094706]|                      [VJ, VJ]|                 [0794, 0213]|          [VII]|           1|   SGN-CXR|
|1742722298728176|    2420|        1661989495| 1V|2G52|           US|              true|                    false|     [ITX1]|                0|               0|     ATL|       false|     USD|  479.2|  68.97|            UA|               [479.2]|              [68.97]|[[AY,11.2], [US,3...|NonRef-Can-Failto...|       [ADT]|         0|                       []|  NYC UA CHI 264.19...|        [153]|                   153|          []|               LGA|                    ORD|            NYC|                 CHI|          20221123|              1500|        20221123|            1633|                     CT|                   CT|        1669237200|      1669242780|                     B|                   1|             false|             [UA]|             [UA]|            [2348]|              [H]|            [E]|      [1]|             [A]|         [320]|          []|[WrappedArray(Wra...|                  []|      [0PC]|           null|                  []|                         []|                           []|                         []|                 []|           []|                                   []|              [009]|               [0]|                             []|                            []|              []|            0|     [163, 166]|                 2112|         []|              ORD|                   EWR|           CHI|                NYC|         20221130|             1355|       20221201|            831|                    CT|                  ET|       1669838100|     1669901460|                    1|                  C|            false|        [UA, UA]|        [UA, UA]|      [2190, 2468]|          [L, G]|        [E, E]|     [1]|         [A, A]|     [319, 739]|         []|[WrappedArray(Wra...|                  []|     [0PC, 0PC]|          null|                [0]|                       [0]|                         [0]|                       [0]|              [, ]|      [, , ]|                                [, ]|        [009, 004]|              [0, 0]|                          [, ]|                         [, ]|          [TPA]|           1|   LGA-ORD|
|1742722298728333|      18|        1661989495| 1G|8K4E|           US|              true|                    false|     [ADT1]|                0|               0|     CHI|       false|     USD|  437.6|  52.48|            AA|               [437.6]|              [52.48]|[[AY,5.6], [US,28...|NonRef-Can-100P-A...|       [ADT]|         0|                       []|  SLC AA X/PHX AA L...|    [105, 85]|                   482|          []|               SLC|                    LAX|            SLC|                 LAX|          20220919|               824|        20220919|            1125|                     MT|                   PT|        1663601040|      1663611900|                  null|                   0|             false|         [AA, AA]|           [, AA]|      [4926, 1270]|           [M, M]|         [E, E]|      [1]|          [P, P]|    [CR7, 320]|          []|[WrappedArray(Wra...|                  []|    [0PC, ]|           null|                 [0]|                        [0]|                          [0]|                        [0]|               [, ]|       [, , ]|                                 [, ]|         [007, 007]|       [1101615, ]|                           [, ]|                          [, ]|           [PHX]|            1|             []|                    0|         []|             null|                  null|          null|               null|                0|                0|              0|              0|                      |                    |                0|              0|                 null|               null|            false|              []|              []|                []|              []|            []|      []|             []|             []|         []|                  []|                  []|             []|          null|                 []|                        []|                          []|                        []|                []|          []|                                  []|                []|                  []|                            []|                           []|             []|          -1|   SLC-LAX|
|1742722298728327|      21|        1661989494| 1P| KJJ|           US|             false|                    false|     [JWZ2]|                0|               0|     DTT|       false|     USD|1405.42| 194.24|            UA|              [702.71]|              [97.12]|[[AY,11.2], [US,4...|NonRef-Can-Failto...|       [ADT]|         0|                       []|  SEA UA HOU161.86U...|   [257, 120]|                  1274|          []|               SEA|                    HSV|            SEA|                 HSV|          20221013|              2338|        20221014|            1215|                     CT|                   CT|        1665722280|      1665767700|                  null|                null|             false|         [UA, UA]|           [UA, ]|      [2379, 4227]|           [T, W]|         [E, E]|      [2]|          [S, S]|    [7M9, ERJ]|          []|[WrappedArray(Wra...|                  []| [0PC, 0PC]|           null|                 [0]|                        [0]|                          [0]|                        [0]|               [, ]|       [, , ]|                                 [, ]|         [002, 009]|[1135120, 1135120]|                           [, ]|                          [, ]|           [IAH]|            1|[123, 165, 181]|                 7473|         []|              HSV|                   SEA|           HSV|                SEA|         20221016|              735|       20221017|           2306|                    CT|                  PT|       1665923700|     1666073160|                 null|               null|            false|    [UA, UA, UA]|      [, UA, UA]|[4717, 2474, 2651]|       [L, T, K]|     [E, E, E]|     [2]|      [S, S, S]|[E7W, 777, 320]|         []|[WrappedArray(Wra...|                  []|[0PC, 0PC, 0PC]|          null|             [0, 0]|                    [0, 0]|                      [0, 0]|                    [0, 0]|            [, , ]|  [, , , , ]|                              [, , ]|   [009, 009, 009]|[1135120, 1135120...|                        [, , ]|                       [, , ]|     [ORD, DEN]|           2|   SEA-HSV|
|1742722298728333|      20|        1661989495| 1G|8K4E|           US|              true|                    false|     [ADT1]|                0|               0|     CHI|       false|     USD|  491.2|  61.43|            AA|               [491.2]|              [61.43]|[[AY,11.2], [US,3...|    Can-Itinchg-0-AT|       [ADT]|         0|                       []|  SLC AA PHX 277.21...|    [105, 85]|                   922|          []|               SLC|                    LAX|            SLC|                 LAX|          20220919|               824|        20220919|            1505|                     MT|                   PT|        1663601040|      1663625100|                  null|                   0|             false|         [AA, AA]|           [, AA]|       [4926, 899]|           [L, N]|         [E, E]|      [1]|          [P, P]|    [CR7, 32Q]|          []|[WrappedArray(Wra...|[WrappedArray(EOF...| [0PC, 0PC]|           null|                 [0]|                        [0]|                          [0]|                        [0]|               [, ]|       [, , ]|                                 [, ]|         [007, 007]|[1101612, 1101612]|                           [, ]|                          [, ]|           [PHX]|            1|             []|                    0|         []|             null|                  null|          null|               null|                0|                0|              0|              0|                      |                    |                0|              0|                 null|               null|            false|              []|              []|                []|              []|            []|      []|             []|             []|         []|                  []|                  []|             []|          null|                 []|                        []|                          []|                        []|                []|          []|                                  []|                []|                  []|                            []|                           []|             []|          -1|   SLC-LAX|
+----------------+--------+------------------+---+----+-------------+------------------+-------------------------+-----------+-----------------+----------------+--------+------------+--------+-------+-------+--------------+----------------------+---------------------+--------------------+--------------------+------------+----------+-------------------------+----------------------+-------------+----------------------+------------+------------------+-----------------------+---------------+--------------------+------------------+------------------+----------------+----------------+-----------------------+---------------------+------------------+----------------+----------------------+--------------------+------------------+-----------------+-----------------+------------------+-----------------+---------------+---------+----------------+--------------+------------+--------------------+--------------------+-----------+---------------+--------------------+---------------------------+-----------------------------+---------------------------+-------------------+-------------+-------------------------------------+-------------------+------------------+-------------------------------+------------------------------+----------------+-------------+---------------+---------------------+-----------+-----------------+----------------------+--------------+-------------------+-----------------+-----------------+---------------+---------------+----------------------+--------------------+-----------------+---------------+---------------------+-------------------+-----------------+----------------+----------------+------------------+----------------+--------------+--------+---------------+---------------+-----------+--------------------+--------------------+---------------+--------------+-------------------+--------------------------+----------------------------+--------------------------+------------------+------------+------------------------------------+------------------+--------------------+------------------------------+-----------------------------+---------------+------------+----------+